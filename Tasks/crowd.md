# Crowd Prediction

## Problem Definition

Given an individual's trajectory $T_i$, the set of cells (tiles) the trajectory intersects in a time interval ![\Large \Delta t](https://latex.codecogs.com/svg.latex?\Delta&space;t)
 is:

![img](http://www.sciweavers.org/tex2img.php?eq=q%5Et_%7BT_u%7D%20%3D%20%5C%7B%20%28p_k%20%5Crightarrow%20t%29%20%5Cin%20%5CDelta%20t%20%5Cwedge%20%28p_k%20%5Crightarrow%20%28x%2Cy%29%29%20%5Cin%20%28i%2Cj%29%20%7C%20%28i%2Cj%29%5C%7D&bc=White&fc=Black&im=jpg&fs=12&ff=arev&edit=0)

where ![img](https://bit.ly/38BfS6S) indicates a cell on a ![img](https://bit.ly/38sxUIH)  grid and ![img](https://bit.ly/38zKeHf) is user ![img](https://bit.ly/2EA5MGt) 's current location.
Let $Q$ be the set of locations covered by all the individual trajectories and let ![img](https://bit.ly/36qMFsI), ![img](https://bit.ly/2mhXb1T), and ![img](https://bit.ly/3ppLWkq) be three consecutive time spans.
The incoming flow to a location ![img](https://bit.ly/38sxUIH) is the number of the individuals that are in ![img](https://bit.ly/38sxUIH) at time ![img](https://bit.ly/2mhXb1T) but were not in ![img](https://bit.ly/38sxUIH) at time ![img](https://bit.ly/36qMFsI):

![img](https://bit.ly/32y1xV0)


Similarly, the outgoing flow to location ![img](https://bit.ly/38sxUIH) is the number of individuals that are in ![img](https://bit.ly/38sxUIH) at time ![img](https://bit.ly/2mhXb1T) and move to another location at time ![img](https://bit.ly/3ppLWkq):

![img](https://bit.ly/38sTlJv)


We can represent the flows of the entire region as a tensor ![img](https://bit.ly/2JLDSdc), where one dimension is associated with the in-flow ![img](https://bit.ly/32qYttZ) and the other with the out-flow ![img](https://bit.ly/36m6f9t).
Therefore, crowd flow prediction is the task of predicting ![img](https://bit.ly/35gJJzJ) given the historical flows ![img](https://bit.ly/2IoP6Ug).
The performance of crowd flow predictors is evaluated as the error (e.g., RMSE, MAE) between the empirical in- and out-flows and the predicted ones.


## Related Papers

|                                                                 **Paper**                                                                 | **Model Name** | **Year** |                **Model**               |  **Evaluation** |                                                                                            **Dataset**                                                                                            |                   **Code**                   |
|:-----------------------------------------------------------------------------------------------------------------------------------------:|:--------------:|:--------:|:--------------------------------------:|:---------------:|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|:--------------------------------------------:|
| *Ren et al.,* A hybrid integrated deep learning model for the prediction of citywide spatio-temporal flow volumes                         | HIDLST         | 2020     | LSTM, ST-ResNet                        | RMSE            | [bit.ly/ST-ResNet](https://bit.ly/ST-ResNet)                                                                                                                                                      | -                                            |
| *Tian et al.,* Deep spatial-temporal networks for crowd flows prediction by dilated convolutions and region-shifting attention mechanism. | LDRSN          | 2020     | Convolutions, Attention Mechanism      | RMSE, MAPE, MAE | [bit.ly/BikeNYCData](https://bit.ly/BikeNYCData) [bit.ly/TaxiNYC-2](https://bit.ly/TaxiNYC-2)                                                                                                     | -                                            |
| *Yuan et al.,* Deep Multi-View Residual Attention Network for Crowd Flows Prediction                                                      | MV-RANet       | 2020     | Residual Attention Network             | RMSE, MAPE      | [bit.ly/ST-ResNet](https://bit.ly/ST-ResNet)                                                                                                                                                      | -                                            |
| *Liu et al.,* Dynamic Spatial-Temporal Representation Learning for Traffic Flow Prediction                                                | ATFM           | 2020     | ConvLSTM                               | RMSE            | [bit.ly/ST-ResNet](https://bit.ly/ST-ResNet)                                                                                                                                                      | [bit.ly/ATFM-2](https://bit.ly/ATFM-2)       |
| *Li et al.,* Densely Connected Convolutional Networks With Attention LSTM for Crowd Flows Prediction                                      | ST-DCCNAL      | 2019     | Densely Connected CNNs, Attention LSTM | RMSE            | [bit.ly/ST-ResNet](https://bit.ly/ST-ResNet)                                                                                                                                                      | [bit.ly/ST-DCCNAL](https://bit.ly/ST-DCCNAL) |
| *Sun et al.,* Predicting citywide crowd flows in irregular regions using multi-view graph convolutional network                           | MVGCN          | 2019     | Graph Convolutional Network            | RMSE, MAE       | [bit.ly/ST-ResNet](https://bit.ly/ST-ResNet) [bit.ly/BikeNYCData](https://bit.ly/BikeNYCData) [bit.ly/BikeWashington](https://bit.ly/BikeWashington) [bit.ly/TaxiNYC-2](https://bit.ly/TaxiNYC-2) | -                                            |
| *Lin et al.,* Deepstn+: Context-aware spatial-temporal neural network for crowd flow prediction in metropolis                             | DeepSTN+       | 2019     | Convolution, Residual Units            | RMSE, MAE       | [bit.ly/BikeNYCData](https://bit.ly/BikeNYCData)                                                                                                                                                  | [bit.ly/DeepSTN](https://bit.ly/DeepSTN)     |
| *Du et al.,* Deep irregular convolutional residual LSTM for urban traffic passenger flows prediction                                      | DST-ICRL       | 2019     | Convolutional Residual Units, LSTM     | RMSE, MAE       | [bit.ly/ST-ResNet](https://bit.ly/ST-ResNet)                                                                                                                                                      | [bit.ly/DST-ICRL](https://bit.ly/DST-ICRL)   |
| *Ai et al.,* A deep learning approach on short-term spatiotemporal distribution forecasting of dockless bike-sharing system.              | -              | 2018     | Convolutional LSTM                     | RMSE, MAE       | -                                                                                                                                                                                                 | -                                            |
| *Yao et al.,* Revisiting Spatial-Temporal Similarity: A Deep Learning Framework for Traffic Prediction                                    | STDN           | 2018     | CNN, LSTM, Attention                   | RMSE, MAPE      | [bit.ly/BikeNYCData](https://bit.ly/BikeNYCData)                                                                                                                                                  | [bit.ly/STDN-2](https://bit.ly/STDN-2)       |
| *Jin et al.,* Spatio-Temporal Recurrent Convolutional Networks for Citywide Short-Term Crowd Flows Prediction                             | STRCNs         | 2018     | CNN, LSTM                              | RMSE            | [bit.ly/ST-ResNet](https://bit.ly/ST-ResNet)                                                                                                                                                      | -                                            |
| *Zonoozi et al.,* Periodic-CRN: A Convolutional Recurrent Model for Crowd Density Prediction with Recurring Periodic Patterns             | PCRN           | 2018     | Convolutional GRU. Convolutions        | RMSE            | [bit.ly/ST-ResNet](https://bit.ly/ST-ResNet)                                                                                                                                                      | -                                            |
| *Want et al.,* Cross-city transfer learning for deep spatio-temporal prediction                                                           | RegionTrans    | 2018     | Convolutional LSTM, CNN                | RMSE            | -                                                                                                                                                                                                 | -                                            |
| *Zhang et al.,* Deep spatio-temporal residual networks for citywide crowd flows prediction                                                | ST-ResNet      | 2017     | Convolutions, Residual Units           | RMSE            | [bit.ly/ST-ResNet](https://bit.ly/ST-ResNet)                                                                                                                                                      | [bit.ly/ST-ResNet](https://bit.ly/ST-ResNet) |s
